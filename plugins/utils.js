export const separator = Symbol("separator");
export const dark_icon =
  "iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAhGVYSWZNTQAqAAAACAAFARIAAwAAAAEAAQAAARoABQAAAAEAAABKARsABQAAAAEAAABSASgAAwAAAAEAAgAAh2kABAAAAAEAAABaAAAAAAAAAJAAAAABAAAAkAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAHAAAAADab9bhAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACQUlEQVRIDbWWzy4lURDG22CwlczsLST+rPAYJCOTeIeZsOBBCAkP4AEsxGOwEnuJDSPWGDOD77vqZ05a99X/VHJuVZ8+VV91VZ2qm2XNaDjUvouvhDzSzFR9rYFE5ULyefL8KZE/TBwNy+viT7Esm8Ze2Mf9fg7TX8RvtHDgSvLXeMeZeOyWYXxPZg3+V+tPyDviJtdHmqbeZhc/hH5Bxn5r5R240958AHVekINh2OxQy+APwS3fh3wgDqU67DXmhH5ZFgzI1xfJS4HCVW0MiuJQCHbiRMugDjfgcPaO9Q6d1lFwMWFkLUCd/8eQATf3Hqn4KdnUui8A7mv3S8tAFGAKjsy7a50b1zK1cgLlLRkyyG1wAIs4qdjUWRPpeHmq8cvXz0oHoH+JzF6ep+mZDjxs1YD/n/ujACW/ecCiZ66odU21o8C1W5SyAeh2RWBle0TLNkyVm1PaRs+kaAC33DKgsn10TqULVUoFLXdDWk3BredaIAqVpyWh97XzVbIhjJR9ab99UncpO+9OS4ceB3YD3GFMq7ofWNE76+LEtmSTCzJNc2/TP4TeE40qRrnIeNU9bPkWzRlI9KYg0+Jg2tHVqgL1O8cVLp2WhP6bvMMQVcxzG57a4lq+9ga+3k70m3ZtHLAuLfpYMuC9Vo8Dq/H1ZdOurQPWJxU/JJvAznztrrR8qMvc552mID1ZmZYSs8yTy4erTLu80brPpIJpmc0EuA21aTpVHUn7ypRzsK81qeXQd/Y/TrbKyE3I/cXYE8/9qaHYyDpOFQAAAABJRU5ErkJggg==";
export const light_icon =
  "iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAhGVYSWZNTQAqAAAACAAFARIAAwAAAAEAAQAAARoABQAAAAEAAABKARsABQAAAAEAAABSASgAAwAAAAEAAgAAh2kABAAAAAEAAABaAAAAAAAAAJAAAAABAAAAkAAAAAEAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAHAAAAADab9bhAAAACXBIWXMAABYlAAAWJQFJUiTwAAABWWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNi4wLjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgoZXuEHAAACa0lEQVRIDbWWzU4UURCFaRSQrQnqKwyuBN4CEwwJb6ALExa4M7DwBdDEBY/BgvAYuBJYm7hBiHEp/4zfudS5uaPgTPdMV1JTdav7nlNddX9mbKyBdLvdCU3DLqMr4U81gKo/BcLKs/C/o9+K8bj91iyEjwSOXUMtaxGbbo04CCbDzsD80+zYH+iT8p1WEoHECWwF+RX2MvzPkcAE49ymkSUCqEs/j38epGUCp8TmIonRLkiAH/hL8HeC/CKszFn428V7eY5jjS3gLv2rIJLR11tK/6WIeJC2amNSTwToYQBO4n8JRpX7b3FsjweeM1wVAKrQBIJdRSXq/03yen8UcyveRtLDnQsAmlzb7jj4vABj2GP87ITo46GTACR9AfZT0PwO+z/jVnyMBFI75NcSGPz1zwu268K/zy3b0xGpsZomsBtM7u99xGXcW3Q3EqhXBZC87RYD1addSdLPd7UWI4nBDidQ8zGKfxAs5T7vR+znnvPVpedB/23JSz5y3wWSgQw8qNVacBUGuy2Z4NJr22krSQxyO6r369YdMe3O2zIfFLyQS0/JPqAz6DVaxhnWEpX8Cn2GrsdMVeZfTIIu/Ry+V7G/gFBjMZZ20Qslge1dkATy4sD3bedTjdDQ4i18920JvHu/VFA1XXwFRHZLLG/L27OBV3zi9bvtMlpDx0d0eVuO50VIa96g8+gF2tsjAiMQrbFzdAF9HXhVWo18kVb8PvoUVQKpJdhRyyWA+qNygnaqqvrlCrwnIPJTtC1yoBP5GVZnwoYC+sMxiz3UALlBnVQKtPDTBdPnQEdkm0Gi/rRNLiqRqxWSzT8lfGH0qqIgbwAAAABJRU5ErkJggg==";

// Copied from https://github.com/sindresorhus/xbar which is under the MIT license.
export function xbar(input, options) {
  console.log(create(input, options));
}

const create = (input, options = {}, menuLevel = 0) => {
  if (typeof options.text !== "undefined") {
    throw new TypeError(
      "The `text` option is not supported as a top-level option. Use it on an item instead."
    );
  }

  return input
    .map((line) => {
      if (typeof line === "string") {
        line = { text: line };
      }

      if (line === separator) {
        return "--".repeat(menuLevel) + "---";
      }

      line = {
        ...options,
        ...line,
      };

      const { text } = line;
      if (typeof text !== "string") {
        throw new TypeError(
          "The `text` property is required and should be a string"
        );
      }

      delete line.text;

      let submenuText = "";
      if (typeof line.submenu === "object" && line.submenu.length > 0) {
        submenuText = `\n${create(line.submenu, options, menuLevel + 1)}`;
        delete line.submenu;
      }

      const prefix = "--".repeat(menuLevel);

      return (
        text
          .split("\n")
          .map((textLine) => {
            const options = Object.entries(line)
              .map(([key, value]) => {
                return `${key}=${value}`;
              })
              .join(" ");

            return `${prefix}${textLine} | ${options}`;
          })
          .join("\n") + submenuText
      );
    })
    .join("\n");
};
